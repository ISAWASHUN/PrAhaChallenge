## Confluenceのようなドキュメント管理システム

【核となるイベント】
ドキュメントの管理するシステムなので、**ドキュメントのCRUD**をすることが、核となるイベント
核となるテーブルはdocument

【リソースの抜き出し】
- **documents**
  - 今回のキーテーブル
- **document_edits**
  - documentsを編集、書き込みする際に複数の人が書き込むので中間テーブルを置く
  - SQLアンチパターン第1章を参照
    - https://zenn.dev/empenguin/articles/dc7dbd4af10847
- **roles**
  - 編集の権限を管理するテーブル
  - 本来document_editsテーブルでカラムとして定義してもよかったが、enumを使用する場合にはすでに決まったstatusがある場合のみ使ってもいいとSQLアンチパターンで書いていたのでテーブルを分割した。
  - https://qiita.com/yk0807/items/90065858733709938d0b
- **users**
  - ユーザーテーブル
- **direcotries**
  - 階層構造の仕様を満たすためのテーブル

## テーブル

**users**

| キー | カラム名   | データ型  | 制約     | 説明                     |
| ---- | ---------- | --------- | -------- | ------------------------ |
| PK   | user_id    | INT       | NOT NULL |                          |
|      | name       | VARCHAR   | NOT NULL | ユーザー名               |
|      | email      | VARCHAR   | NOT NULL | メールアドレス           |
|      | created_at | DATETTIME | NOT NULL |                          |
|      | updated_at | DATETTIME | NOT NULL |                          |

**Documents**

| キー | カラム名     | データ型  | 制約     | 説明                        |
| ---- | ------------ | --------- | -------- | --------------------------- |
| PK   | document_id  | INT       | NOT NULL |                             |
| FK   | directory_id | INT       | NOT NULL | directoryテーブルと紐付ける |
|      | title        | VARCHAR   | NOT NULL | ドキュメントのtitle         |
|      | content      | VARCHAR   | NOT NULL | ドキュメントの内容          |
|      | created_at   | DATETTIME | NOT NULL |                             |
|      | updated_at   | DATETTIME | NOT NULL |                             |

**documet_edits**

| キー | カラム名        | データ型  | 制約     | 説明 |
| ---- | --------------- | --------- | -------- | ---- |
| PK   | documet_edit_id | INT       | NOT NULL |      |
| FK   | user_id         | INT       | NOT NULL |      |
| FK   | documet_id      | INT       | NOT NULL |      |
|      | created_at      | DATETTIME | NOT NULL |      |
|      | updated_at      | DATETTIME | NOT NULL |      |

**role**

| キー | カラム名   | データ型  | 制約     | 説明   |
| ---- | ---------- | --------- | -------- | ------ |
| PK   | role_id    | INT       | NOT NULL |        |
| FK   | documet_id | INT       | NOT NULL |        |
|      | role_name  | VARCHAR   | NOT NULL | 権限名 |
|      | created_at | DATETTIME | NOT NULL |        |
|      | updated_at | DATETTIME | NOT NULL |        |

